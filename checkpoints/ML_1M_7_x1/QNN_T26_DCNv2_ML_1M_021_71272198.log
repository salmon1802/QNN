2024-12-14 16:13:13,712 P3739813 INFO Params: {
    "batch_norm": "True",
    "batch_size": "4096",
    "data_format": "csv",
    "data_root": "../../../data/",
    "dataset_id": "ML_1M_7_x1",
    "debug_mode": "False",
    "early_stop_patience": "2",
    "embedding_dim": "16",
    "embedding_regularizer": "0.01",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'str', 'name': ['UserID', 'Gender', 'Age', 'Occupation', 'MovieID', 'Release'], 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'encoder': 'MaskedSumPooling', 'max_len': 5, 'name': 'Genres', 'splitter': '^', 'type': 'sequence'}]",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "1",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'Label'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "model": "QNN_T26_DCNv2",
    "model_id": "QNN_T26_DCNv2_ML_1M_021_71272198",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': 0}",
    "monitor_mode": "max",
    "net_dropout": "0.1",
    "net_regularizer": "0",
    "num_cross_layers": "2",
    "num_heads": "4",
    "num_layers": "1",
    "num_row": "4",
    "num_workers": "8",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "../../../data/ML_1M/test.csv",
    "train_data": "../../../data/ML_1M/train.csv",
    "use_features": "None",
    "valid_data": "../../../data/ML_1M/valid.csv",
    "verbose": "1"
}
2024-12-14 16:13:13,713 P3739813 INFO Set up feature processor...
2024-12-14 16:13:13,713 P3739813 WARNING Skip rebuilding ../../../data/ML_1M_7_x1/feature_map.json. Please delete it manually if rebuilding is required.
2024-12-14 16:13:13,713 P3739813 INFO Load feature_map from json: ../../../data/ML_1M_7_x1/feature_map.json
2024-12-14 16:13:13,713 P3739813 INFO Set column index...
2024-12-14 16:13:13,713 P3739813 INFO Feature specs: {
    "Age": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 8, 'vocab_size': 9}",
    "Gender": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "Genres": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'padding_idx': 0, 'oov_idx': 19, 'vocab_size': 20, 'max_len': 5}",
    "MovieID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3642, 'vocab_size': 3643}",
    "Occupation": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 22, 'vocab_size': 23}",
    "Release": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 9, 'vocab_size': 10}",
    "UserID": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 6041, 'vocab_size': 6042}"
}
2024-12-14 16:13:18,369 P3739813 INFO Total number of parameters: 233521.
2024-12-14 16:13:18,370 P3739813 INFO Loading data...
2024-12-14 16:13:18,370 P3739813 INFO Loading data from h5: ../../../data/ML_1M_7_x1/train.h5
2024-12-14 16:13:18,451 P3739813 INFO Train samples: total/591209, blocks/1
2024-12-14 16:13:18,451 P3739813 INFO Loading data from h5: ../../../data/ML_1M_7_x1/valid.h5
2024-12-14 16:13:18,459 P3739813 INFO Validation samples: total/73901, blocks/1
2024-12-14 16:13:18,459 P3739813 INFO Loading train and validation data done.
2024-12-14 16:13:18,459 P3739813 INFO Start training: 145 batches/epoch
2024-12-14 16:13:18,459 P3739813 INFO ************ Epoch=1 start ************
2024-12-14 16:13:27,198 P3739813 INFO Train loss: 1.389735
2024-12-14 16:13:27,198 P3739813 INFO Evaluation @epoch 1 - batch 145: 
2024-12-14 16:13:28,442 P3739813 INFO ===
2024-12-14 16:13:28,442 P3739813 INFO [Metrics] AUC: 0.863713 - logloss: 0.358021
2024-12-14 16:13:28,443 P3739813 INFO Save best model: monitor(max)=0.863713
2024-12-14 16:13:28,604 P3739813 INFO ************ Epoch=1 end ************
2024-12-14 16:13:35,875 P3739813 INFO Train loss: 1.111265
2024-12-14 16:13:35,876 P3739813 INFO Evaluation @epoch 2 - batch 145: 
2024-12-14 16:13:36,923 P3739813 INFO ===
2024-12-14 16:13:36,923 P3739813 INFO [Metrics] AUC: 0.870251 - logloss: 0.357780
2024-12-14 16:13:36,923 P3739813 INFO Save best model: monitor(max)=0.870251
2024-12-14 16:13:37,068 P3739813 INFO ************ Epoch=2 end ************
2024-12-14 16:13:44,496 P3739813 INFO Train loss: 1.078306
2024-12-14 16:13:44,496 P3739813 INFO Evaluation @epoch 3 - batch 145: 
2024-12-14 16:13:45,587 P3739813 INFO ===
2024-12-14 16:13:45,587 P3739813 INFO [Metrics] AUC: 0.878184 - logloss: 0.342103
2024-12-14 16:13:45,587 P3739813 INFO Save best model: monitor(max)=0.878184
2024-12-14 16:13:45,758 P3739813 INFO ************ Epoch=3 end ************
2024-12-14 16:13:54,045 P3739813 INFO Train loss: 1.052748
2024-12-14 16:13:54,046 P3739813 INFO Evaluation @epoch 4 - batch 145: 
2024-12-14 16:13:55,285 P3739813 INFO ===
2024-12-14 16:13:55,285 P3739813 INFO [Metrics] AUC: 0.884881 - logloss: 0.329482
2024-12-14 16:13:55,286 P3739813 INFO Save best model: monitor(max)=0.884881
2024-12-14 16:13:55,479 P3739813 INFO ************ Epoch=4 end ************
2024-12-14 16:14:04,506 P3739813 INFO Train loss: 1.031917
2024-12-14 16:14:04,507 P3739813 INFO Evaluation @epoch 5 - batch 145: 
2024-12-14 16:14:05,790 P3739813 INFO ===
2024-12-14 16:14:05,790 P3739813 INFO [Metrics] AUC: 0.889038 - logloss: 0.323375
2024-12-14 16:14:05,790 P3739813 INFO Save best model: monitor(max)=0.889038
2024-12-14 16:14:05,968 P3739813 INFO ************ Epoch=5 end ************
2024-12-14 16:14:15,106 P3739813 INFO Train loss: 1.014751
2024-12-14 16:14:15,107 P3739813 INFO Evaluation @epoch 6 - batch 145: 
2024-12-14 16:14:16,462 P3739813 INFO ===
2024-12-14 16:14:16,462 P3739813 INFO [Metrics] AUC: 0.891695 - logloss: 0.320450
2024-12-14 16:14:16,462 P3739813 INFO Save best model: monitor(max)=0.891695
2024-12-14 16:14:16,613 P3739813 INFO ************ Epoch=6 end ************
2024-12-14 16:14:25,448 P3739813 INFO Train loss: 1.003824
2024-12-14 16:14:25,449 P3739813 INFO Evaluation @epoch 7 - batch 145: 
2024-12-14 16:14:26,857 P3739813 INFO ===
2024-12-14 16:14:26,857 P3739813 INFO [Metrics] AUC: 0.893187 - logloss: 0.318025
2024-12-14 16:14:26,858 P3739813 INFO Save best model: monitor(max)=0.893187
2024-12-14 16:14:27,013 P3739813 INFO ************ Epoch=7 end ************
2024-12-14 16:14:35,075 P3739813 INFO Train loss: 0.994342
2024-12-14 16:14:35,075 P3739813 INFO Evaluation @epoch 8 - batch 145: 
2024-12-14 16:14:36,552 P3739813 INFO ===
2024-12-14 16:14:36,552 P3739813 INFO [Metrics] AUC: 0.894667 - logloss: 0.316807
2024-12-14 16:14:36,552 P3739813 INFO Save best model: monitor(max)=0.894667
2024-12-14 16:14:36,751 P3739813 INFO ************ Epoch=8 end ************
2024-12-14 16:14:45,438 P3739813 INFO Train loss: 0.987122
2024-12-14 16:14:45,438 P3739813 INFO Evaluation @epoch 9 - batch 145: 
2024-12-14 16:14:46,668 P3739813 INFO ===
2024-12-14 16:14:46,668 P3739813 INFO [Metrics] AUC: 0.895567 - logloss: 0.317129
2024-12-14 16:14:46,668 P3739813 INFO Save best model: monitor(max)=0.895567
2024-12-14 16:14:46,828 P3739813 INFO ************ Epoch=9 end ************
2024-12-14 16:14:55,720 P3739813 INFO Train loss: 0.980690
2024-12-14 16:14:55,720 P3739813 INFO Evaluation @epoch 10 - batch 145: 
2024-12-14 16:14:57,081 P3739813 INFO ===
2024-12-14 16:14:57,081 P3739813 INFO [Metrics] AUC: 0.895965 - logloss: 0.313477
2024-12-14 16:14:57,081 P3739813 INFO Save best model: monitor(max)=0.895965
2024-12-14 16:14:57,252 P3739813 INFO ************ Epoch=10 end ************
2024-12-14 16:15:05,958 P3739813 INFO Train loss: 0.977003
2024-12-14 16:15:05,958 P3739813 INFO Evaluation @epoch 11 - batch 145: 
2024-12-14 16:15:07,328 P3739813 INFO ===
2024-12-14 16:15:07,329 P3739813 INFO [Metrics] AUC: 0.896934 - logloss: 0.312515
2024-12-14 16:15:07,329 P3739813 INFO Save best model: monitor(max)=0.896934
2024-12-14 16:15:07,471 P3739813 INFO ************ Epoch=11 end ************
2024-12-14 16:15:16,493 P3739813 INFO Train loss: 0.969694
2024-12-14 16:15:16,493 P3739813 INFO Evaluation @epoch 12 - batch 145: 
2024-12-14 16:15:17,838 P3739813 INFO ===
2024-12-14 16:15:17,839 P3739813 INFO [Metrics] AUC: 0.897483 - logloss: 0.311618
2024-12-14 16:15:17,839 P3739813 INFO Save best model: monitor(max)=0.897483
2024-12-14 16:15:18,016 P3739813 INFO ************ Epoch=12 end ************
2024-12-14 16:15:26,707 P3739813 INFO Train loss: 0.966939
2024-12-14 16:15:26,708 P3739813 INFO Evaluation @epoch 13 - batch 145: 
2024-12-14 16:15:27,983 P3739813 INFO ===
2024-12-14 16:15:27,983 P3739813 INFO [Metrics] AUC: 0.898251 - logloss: 0.310684
2024-12-14 16:15:27,983 P3739813 INFO Save best model: monitor(max)=0.898251
2024-12-14 16:15:28,124 P3739813 INFO ************ Epoch=13 end ************
2024-12-14 16:15:36,965 P3739813 INFO Train loss: 0.962294
2024-12-14 16:15:36,965 P3739813 INFO Evaluation @epoch 14 - batch 145: 
2024-12-14 16:15:38,235 P3739813 INFO ===
2024-12-14 16:15:38,235 P3739813 INFO [Metrics] AUC: 0.899073 - logloss: 0.310426
2024-12-14 16:15:38,235 P3739813 INFO Save best model: monitor(max)=0.899073
2024-12-14 16:15:38,431 P3739813 INFO ************ Epoch=14 end ************
2024-12-14 16:15:47,213 P3739813 INFO Train loss: 0.959527
2024-12-14 16:15:47,213 P3739813 INFO Evaluation @epoch 15 - batch 145: 
2024-12-14 16:15:48,251 P3739813 INFO ===
2024-12-14 16:15:48,252 P3739813 INFO [Metrics] AUC: 0.899186 - logloss: 0.310806
2024-12-14 16:15:48,252 P3739813 INFO Save best model: monitor(max)=0.899186
2024-12-14 16:15:48,419 P3739813 INFO ************ Epoch=15 end ************
2024-12-14 16:15:55,311 P3739813 INFO Train loss: 0.954854
2024-12-14 16:15:55,311 P3739813 INFO Evaluation @epoch 16 - batch 145: 
2024-12-14 16:15:56,322 P3739813 INFO ===
2024-12-14 16:15:56,322 P3739813 INFO [Metrics] AUC: 0.899333 - logloss: 0.309513
2024-12-14 16:15:56,322 P3739813 INFO Save best model: monitor(max)=0.899333
2024-12-14 16:15:56,461 P3739813 INFO ************ Epoch=16 end ************
2024-12-14 16:16:05,086 P3739813 INFO Train loss: 0.952068
2024-12-14 16:16:05,087 P3739813 INFO Evaluation @epoch 17 - batch 145: 
2024-12-14 16:16:06,363 P3739813 INFO ===
2024-12-14 16:16:06,363 P3739813 INFO [Metrics] AUC: 0.899988 - logloss: 0.308235
2024-12-14 16:16:06,364 P3739813 INFO Save best model: monitor(max)=0.899988
2024-12-14 16:16:06,564 P3739813 INFO ************ Epoch=17 end ************
2024-12-14 16:16:15,153 P3739813 INFO Train loss: 0.948419
2024-12-14 16:16:15,154 P3739813 INFO Evaluation @epoch 18 - batch 145: 
2024-12-14 16:16:16,430 P3739813 INFO ===
2024-12-14 16:16:16,431 P3739813 INFO [Metrics] AUC: 0.901029 - logloss: 0.307040
2024-12-14 16:16:16,431 P3739813 INFO Save best model: monitor(max)=0.901029
2024-12-14 16:16:16,586 P3739813 INFO ************ Epoch=18 end ************
2024-12-14 16:16:25,259 P3739813 INFO Train loss: 0.945230
2024-12-14 16:16:25,259 P3739813 INFO Evaluation @epoch 19 - batch 145: 
2024-12-14 16:16:26,557 P3739813 INFO ===
2024-12-14 16:16:26,557 P3739813 INFO [Metrics] AUC: 0.900175 - logloss: 0.308255
2024-12-14 16:16:26,557 P3739813 INFO Monitor(max)=0.900175 STOP!
2024-12-14 16:16:26,557 P3739813 INFO Reduce learning rate on plateau: 0.000100
2024-12-14 16:16:26,686 P3739813 INFO ************ Epoch=19 end ************
2024-12-14 16:16:34,417 P3739813 INFO Train loss: 0.890155
2024-12-14 16:16:34,417 P3739813 INFO Evaluation @epoch 20 - batch 145: 
2024-12-14 16:16:35,481 P3739813 INFO ===
2024-12-14 16:16:35,481 P3739813 INFO [Metrics] AUC: 0.905626 - logloss: 0.300566
2024-12-14 16:16:35,482 P3739813 INFO Save best model: monitor(max)=0.905626
2024-12-14 16:16:35,606 P3739813 INFO ************ Epoch=20 end ************
2024-12-14 16:16:43,336 P3739813 INFO Train loss: 0.847965
2024-12-14 16:16:43,336 P3739813 INFO Evaluation @epoch 21 - batch 145: 
2024-12-14 16:16:44,519 P3739813 INFO ===
2024-12-14 16:16:44,519 P3739813 INFO [Metrics] AUC: 0.907495 - logloss: 0.298129
2024-12-14 16:16:44,519 P3739813 INFO Save best model: monitor(max)=0.907495
2024-12-14 16:16:44,680 P3739813 INFO ************ Epoch=21 end ************
2024-12-14 16:16:53,496 P3739813 INFO Train loss: 0.828972
2024-12-14 16:16:53,496 P3739813 INFO Evaluation @epoch 22 - batch 145: 
2024-12-14 16:16:54,798 P3739813 INFO ===
2024-12-14 16:16:54,798 P3739813 INFO [Metrics] AUC: 0.908053 - logloss: 0.297817
2024-12-14 16:16:54,798 P3739813 INFO Save best model: monitor(max)=0.908053
2024-12-14 16:16:54,951 P3739813 INFO ************ Epoch=22 end ************
2024-12-14 16:17:03,680 P3739813 INFO Train loss: 0.812961
2024-12-14 16:17:03,681 P3739813 INFO Evaluation @epoch 23 - batch 145: 
2024-12-14 16:17:04,924 P3739813 INFO ===
2024-12-14 16:17:04,924 P3739813 INFO [Metrics] AUC: 0.907980 - logloss: 0.298644
2024-12-14 16:17:04,925 P3739813 INFO Monitor(max)=0.907980 STOP!
2024-12-14 16:17:04,925 P3739813 INFO Reduce learning rate on plateau: 0.000010
2024-12-14 16:17:05,067 P3739813 INFO ************ Epoch=23 end ************
2024-12-14 16:17:13,935 P3739813 INFO Train loss: 0.800048
2024-12-14 16:17:13,935 P3739813 INFO Evaluation @epoch 24 - batch 145: 
2024-12-14 16:17:15,332 P3739813 INFO ===
2024-12-14 16:17:15,332 P3739813 INFO [Metrics] AUC: 0.907976 - logloss: 0.298727
2024-12-14 16:17:15,332 P3739813 INFO Monitor(max)=0.907976 STOP!
2024-12-14 16:17:15,332 P3739813 INFO Reduce learning rate on plateau: 0.000001
2024-12-14 16:17:15,332 P3739813 INFO ********* Epoch==24 early stop *********
2024-12-14 16:17:15,488 P3739813 INFO Training finished.
2024-12-14 16:17:15,488 P3739813 INFO Load best model: /mnt/public/lhh/code/model_zoo/QNN/QNN_torch/checkpoints/ML_1M_7_x1/QNN_T26_DCNv2_ML_1M_021_71272198.model
2024-12-14 16:17:15,492 P3739813 INFO ****** Validation evaluation ******
2024-12-14 16:17:16,874 P3739813 INFO ===
2024-12-14 16:17:16,874 P3739813 INFO [Metrics] logloss: 0.297817 - AUC: 0.908053
2024-12-14 16:17:16,971 P3739813 INFO ******** Test evaluation ********
2024-12-14 16:17:16,971 P3739813 INFO Loading data...
2024-12-14 16:17:16,971 P3739813 INFO Loading data from h5: ../../../data/ML_1M_7_x1/test.h5
2024-12-14 16:17:16,981 P3739813 INFO Test samples: total/73902, blocks/1
2024-12-14 16:17:16,981 P3739813 INFO Loading test data done.
2024-12-14 16:17:18,236 P3739813 INFO ===
2024-12-14 16:17:18,236 P3739813 INFO [Metrics] logloss: 0.295782 - AUC: 0.909169
